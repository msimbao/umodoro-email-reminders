// package.json
{
  "name": "reminder-service",
  "version": "1.0.0",
  "description": "Email reminder service for study app",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "firebase-admin": "^12.0.0",
    "nodemailer": "^6.9.7",
    "dotenv": "^16.3.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.2"
  },
  "engines": {
    "node": ">=18.0.0"
  }
}

// .env.example
// Copy this to .env and fill in your values
// DO NOT commit .env to git

# Firebase Admin SDK Configuration
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_CLIENT_EMAIL=your-service-account-email
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nyour-private-key\n-----END PRIVATE KEY-----\n"

# Email Configuration (Gmail example)
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password

# Security
API_KEY=your-random-api-key-for-manual-testing
CRON_SECRET=your-random-cron-secret

# Server
PORT=3000

// .gitignore
node_modules/
.env
*.log
.DS_Store

// README.md
# Reminder Email Service

This service processes study reminders from Firestore and sends email notifications to users.

## Setup Instructions

### 1. Get Firebase Admin Credentials

1. Go to Firebase Console > Project Settings > Service Accounts
2. Click "Generate New Private Key"
3. Download the JSON file
4. Extract these values:
   - `project_id` → FIREBASE_PROJECT_ID
   - `client_email` → FIREBASE_CLIENT_EMAIL
   - `private_key` → FIREBASE_PRIVATE_KEY

### 2. Setup Email Service

#### Option A: Gmail (Easy for testing)
1. Enable 2-factor authentication on your Gmail account
2. Generate an App Password: https://myaccount.google.com/apppasswords
3. Use your Gmail and the App Password

#### Option B: SendGrid (Recommended for production)
1. Sign up at https://sendgrid.com
2. Create an API key
3. Change the transporter in server.js to use SendGrid

#### Option C: Resend (Modern alternative)
1. Sign up at https://resend.com
2. Get your API key
3. Update transporter to use Resend

### 3. Deploy to Render

1. Push your code to GitHub
2. Go to https://render.com and sign up
3. Create a new Web Service
4. Connect your GitHub repository
5. Set environment variables in Render dashboard
6. Deploy!

### 4. Setup Cron Job on Render

1. In Render dashboard, create a new Cron Job
2. Name it "Process Reminders"
3. Command: `curl -H "x-cron-secret: YOUR_CRON_SECRET" https://your-app.onrender.com/cron/process-reminders`
4. Schedule: Every hour (0 * * * *) or every 15 minutes (*/15 * * * *)

## Environment Variables

Add these in Render dashboard under "Environment" tab:

- `FIREBASE_PROJECT_ID`
- `FIREBASE_CLIENT_EMAIL`
- `FIREBASE_PRIVATE_KEY`
- `EMAIL_USER`
- `EMAIL_PASSWORD`
- `API_KEY` (generate a random string)
- `CRON_SECRET` (generate a random string)

## Testing

### Local Testing
```bash
npm install
# Create .env file with your credentials
npm start
# Visit http://localhost:3000/process-reminders with API key header
```

### Test Reminder Processing
```bash
curl -H "x-api-key: YOUR_API_KEY" http://localhost:3000/process-reminders
```

## Cron Schedule Examples

- Every 15 minutes: `*/15 * * * *`
- Every hour: `0 * * * *`
- Every day at 8 AM: `0 8 * * *`
- Every weekday at 9 AM: `0 9 * * 1-5`

## Security Notes

- Never commit `.env` file
- Use strong random strings for API_KEY and CRON_SECRET
- Keep Firebase private key secure
- Use App Passwords for Gmail, never your main password